<div class="payroll-dashboard">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="header-text">
      <h1>Employee Payroll</h1>
      <p>Keep track employee salary on daily basis.</p>
    </div>
    <button class="export-button" (click)="exportPayroll()">
      <i class="bi bi-box-arrow-up"></i>
      Generate Monthly Payroll
    </button>
  </div>

  <hr class="header-divider">

  <!-- Main Content Area -->
  <div class="dashboard-content">
    <!-- Filters Section -->
    <div class="filters-section">
      <!-- Branch, Department, Date Filters -->
      <div class="filters-container">
        <div class="filter-group">
          <label>Branch</label>
          <select [(ngModel)]="selectedBranch" (change)="onBranchChange()">
            <option *ngFor="let branch of branches" [value]="branch.branchId">
              {{ branch.branchName }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label>Department</label>
          <select [(ngModel)]="selectedDepartment" (change)="applyFilters()">
            <option *ngFor="let dept of filteredDepartments" [value]="dept.dept_id">
              {{ dept.dept_name }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label>Year</label>
          <select [(ngModel)]="selectedYear" (ngModelChange)="onYearChange($event)">
            <option *ngFor="let y of years" [value]="y">{{ y }}</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label>Month</label>
          <select [(ngModel)]="selectedMonth" (ngModelChange)="onMonthChange($event)">
            <option *ngFor="let m of months" [value]="m.value">{{ m.name }}</option>
          </select>
        </div>
      </div>

      <!-- Search and Filter Buttons -->
      <div class="search-filter-container">
        <div class="search-container">
          <i class="search-icon bi bi-search"></i>
          <input type="text" placeholder="Search employees..." [(ngModel)]="searchQuery" (keyup.enter)="searchEmployees()">
        </div>
        <button class="filter-button">
          <i class="bi bi-funnel"></i>
          Advanced Filter
        </button>
      </div>
    </div>

    <!-- Data Table -->
    <div class="table-section">
      <div class="table-wrapper">
        <table class="payroll-table">
          <thead>
            <tr>
              <th>Employee ID</th>
              <th>Employee</th>
              <th>Department</th>
              <th>Net Salary</th>
              <th>Pay Month</th>
              <th>Status</th>
              <th>Over Time</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="filteredEmployees.length === 0">
              <td colspan="8" class="no-data">No data found for the selected criteria.</td>
            </tr>
            <tr *ngFor="let employee of filteredEmployees">
              <td class="employee-id">{{ employee.empCode }}</td>
              <td class="employee-name-cell">
                <div class="employee-name">{{ employee.name }}</div>
              </td>
              <td class="department">{{ employee.department }}</td>
              <td class="salary">Nu. {{ employee.netSalary }}</td>
              <td class="pay-month">{{ employee.salaryMonth }}</td>
              <td class="status-cell">
                <span class="status-badge" [class.paid]="employee.status === 'active'" [class.unpaid]="employee.status !== 'active'">
                  {{ getStatusText(employee.status) }}
                </span>
              </td>
              <td class="overtime">{{ employee.overtime }}</td>
              <td class="action-cell">
                <div class="action-buttons">
                  <button class="view-btn view-tds-btn" [routerLink]="['/view/tds', employee.id]" [queryParams]="{ year: selectedYear, month: selectedMonth }">
                    View TDS
                  </button>
                  <button class="view-btn view-salary-btn" 
        [routerLink]="['/view/pay-slip', employee.id]">
  View Payslip
</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>